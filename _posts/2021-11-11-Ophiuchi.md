---
layout: post
title: HackTheBox Ophiuchi Write-up
---

<h2>Overview</h2>

Ophiuchi is a Medium-rated Hackthebox linux machine. I gain a foothold via an exposed yaml parser with unrestricted Java methods allowing RCE and a shell as the user tomcat. From there, exposed credentials allow a quick escalation to the user "admin". As admin, I discover I'm able to run a go script as superuser. The file loads scripts without specifying full filepaths, allowing script hijacking and command execution as root.

<h2>Initial Enumeration</h2>

Initial nmap enumeration reveals two ports open: SSH on port 22, and Apache Tomcat site on port 8080.

┌──(kali㉿kali)-[~/…/Labs/htb/htb-active/Ophiuchi]
└─$ sudo nmap -sC -sV --min-rate 10000 10.10.10.227
[sudo] password for kali: 
Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-08 23:01 GMT
Nmap scan report for ophiuchi.htb (10.10.10.227)
Host is up (0.043s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 6d:fc:68:e2:da:5e:80:df:bc:d0:45:f5:29:db:04:ee (RSA)
|   256 7a:c9:83:7e:13:cb:c3:f9:59:1e:53:21:ab:19:76:ab (ECDSA)
|_  256 17:6b:c3:a8:fc:5d:36:08:a1:40:89:d2:f4:0a:c6:46 (ED25519)
8080/tcp open  http    Apache Tomcat 9.0.38
|_http-title: Parse YAML
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.34 seconds![image](https://user-images.githubusercontent.com/44827973/141241262-3409fed4-2bc0-47ef-9096-64f8af05ef93.png)

Heading over to port 8080 on a browser reveals an "Online YAML Parser":

![image](https://user-images.githubusercontent.com/44827973/141241523-217abe00-67cf-48a1-8c6f-5e6e8fa2ca59.png)

Testing some gibberish input and clicking parse, I get redirected to this security message:

![image](https://user-images.githubusercontent.com/44827973/141241584-ed9f2860-720c-4a9d-bca7-ee306f6a4d64.png)


